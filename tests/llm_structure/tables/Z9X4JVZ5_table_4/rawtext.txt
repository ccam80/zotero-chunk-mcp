Sensors 2019, 19, 959
18 of 24
Table 4. Poles of highpass ﬁlters with quantized coefﬁcients.
fC
20 Hz
30 Hz
40 Hz
50 Hz
60 Hz
Che
0.992 ± 0.013i
0.988 ± 0.020i
0.984 ± 0.025i
0.980 ± 0.032i
0.976 ± 0.039i
But
0.991 ± 0.007i
0.987 ± 0.011i
0.982 ± 0.015i
0.978 ± 0.021i
0.974 ± 0.025i
fC
70 Hz
80 Hz
90 Hz
100 Hz
Che
0.972 ± 0.045i
0.968 ± 0.051i
0.964 ± 0.057i
0.961 ± 0.057i
But
0.969 ± 0.030i
0.965 ± 0.033i
0.960 ± 0.037i
0.956 ± 0.041i
4.4. Cascaded Filter Transfer Function
Figure 15 shows the transfer function of the selected comb (5 Hz But), highpass (60 Hz Che) and
lowpass (fC = 531 Hz).
0
200
400
600
800
1,000
−100
−50
0
Frequency (Hz)
|g[f]| (dB)
Figure 15. Transfer function of the cascaded comb, highpass and lowpass ﬁlter (including compensation
of scaling S).
4.5. Rectiﬁcation and Smoothing
Linear rectiﬁcation was chosen for the ﬁnal implementation, as it enables better proportional
control than squared rectiﬁcation. Since the values of squared high signals are much greater than those
of squared small signals, the small signal amplitudes from noise, but also weak contractions, vanish
due to the squaring. The slope steepness is better for squaring, but with linear rectiﬁcation sufﬁcient
steepness of the signal slopes still can be achieved for light co-contractions.
The cutoff frequency fC was set to 3.11 Hz. This lowpass, which is a discrete ﬁrst-order lag
element, has a time constant T of 51.1 ms. A lower fC would lead to longer delays, and a higher fC
would not smooth the signal sufﬁciently for a stable prosthesis control. Figure 16 shows the rectiﬁed
and smoothed signals of various movements. As the prosthesis drive has an integrated lowpass
characteristic, a slight ripple in the smoothed signal does not affect the drive speed.
4.6. Runtime
The runtimes of the implemented signal processing chain for various ﬁlters are listed in Table 5.
Different lowpass implementations at a 48 MHz clock frequency are compared in Table 6. The runtime
is inversely proportional to the clock frequency, i.e., decreasing the clock frequency by half will double
the runtime. Avoiding FIR ﬁlters is recommended for real-time ultra-low-power systems, as runtime is
signiﬁcantly longer, depending on the order of the ﬁlter. Furthermore, the ﬁfth-order FIR ﬁlter has
a poorer damping characteristic than the presented IIR ﬁlter. In many EMG systems, FIR ﬁlters have
window sizes of 50–350 ms [44], implying a ﬁlter order of 500–3500. Such ﬁlters cannot be calculated
in real-time with this system. The selected implementation requires less calculation effort than the
